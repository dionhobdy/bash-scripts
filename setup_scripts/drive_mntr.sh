#!/bin/bash
# drv_mntr.sh
# a simple script to display drive information and mount drives

cat <<EOF
â €â €â €â €â €â €â €â €â €â €â €â €â¡€â €â „â  â¢€â €â €â „â €â  â â  â â¢†â¡˜â  â¢“â „â¡‚â †â¡˜â „â °â €â â¢‚â €â „â¢¢â Œâ ²â¢©â¡â „â¡‚â ¤â â €â  â¢€â â €â¡€â €â €â €â¡€â¢€â  â €â ”â  â¢°
â €â €â €â €â €â €â €â €â €â¡€â â¢„â¡â €â Œâ â „â ‚â €â ‚â â €â „â €â¡â ‚â  â¢â Šâ °â â¡ â â ˜â¡€â €â €â¡€â ¡â ˜â ¤â Šâ ‘â¡„â¡›â ¤â£â †â¡â ˆâ €â¡€â „â â  â¢€â ¡â â €â „â¢‚â ‰â¡”â¢¢â¢§
â €â €â €â â  â â €â „â ‚â „â ‘â  â €â¢‰â €â ‚â â ˆâ „â¡€â €â €â €â¢€â €â €â €â „â €â â €â â €â â¢â €â €â¡€â „â ˆâ €â¡â €â €â¢£â ‘â ‚â Œâ¡€â¢‚â ¡â¢€â Œâ¡ â¢‘â €â ‚â¡â¡â¢Œâ °â ˆâ¡´â£›â¢®
â €â¢€â  â â  â¢‚â¢â Šâ â ˆâ ˆâ €â Œâ €â â €â €â €â €â â €â €â €â €â €â ˆâ €â €â â €â ‚â €â €â¡ˆâ €â €â €â €â ˆâ €â¡€â €â â €â â¢€â¡‰â €â „â  â €â¡ˆâ ¤â¡â¢†â ˆâ¡â  â Œâ¡ â¢‚â¡¹â£–â£­â¡¿
â €â ¤â¢€â ¢â â ‚â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â „â €â €â¢â ‚â €â¢€â €â €â  â €â â ˆâ €â¢€â €â €â €â €â €â ¡â â¡¡â¢‰â ¢â¢¡â â¡â †â¡‘â¢¦â£Ÿâ¡¾â£¿â£¿
â €â ‚â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â ˆâ €â Œâ €â €â ‚â¢€â €â ¡â €â €â €â €â „â €â €â ˆâ €â €â €â ˆâ €â¡â ¡â ˆâ ¦â ‘â¡–â£Œâ ¢â¡™â£¼â£½â£¿â£¿â£¿
â €â €â â  â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â ¡â¢€â ‚â Œâ¡„â €â  â ˜â €â¢ â €â €â¡„â â €â „â €â €â €â €â¢€â €â €â ‚â „â â ˆâ €â €â ˆâ ”â¢£â£™â£¶â£¿â£¿â£¿â£¿
â €â  â¢„â£¡â €â €â €â¢€â ‚â €â €â €â €â €â ˆâ ˆâ ƒâ €â €â €â €â €â €â¢Œâ °â£ˆâ ¤â£‚â †â¡Œâ¢‚â °â Œâ â¡ˆâ â €â â¢€â  â¢™â¡°â¡ˆâ¡€â¢€â â €â ‚â €â €â €â €â €â €â €â €â €â €â  â£™â£¿â£¿â£¿â£¿â£¿
â¢€â ’â¡¬â¢‘â¡‚â €â €â Œâ €â €â €â €â €â €â €â €â €â €â €â €â¡â €â €â ˆâ¢²â¡±â£²â£¡â â â£Šâ¢¡â â¢ â¢ â¢¡â €â¡ˆâ ‚â ±â£„â ƒâ¡Ÿâ¡¥â£ â â €â €â €â €â¢€â  â¢ â¡€â €â¢¢â €â €â ‚â£œâ£»â£¿â£¿â£¿â£¿
â €â¢â â ¯â ³â¡„â „â €â¡â €â €â €â €â €â €â „â €â €â €â €â †â €â €â €â €â¡³â¡—â£¦â¢‹â¢œâ£ â ‡â£®â£‘â¡ˆâ¡¼â¢…â °â¡±â£â¡Šâ ¢â¡œâ¡¸â£¿â „â €â €â €â €â  â €â €â €â €â €â£³â €â¢„â¢ªâ¡¿â£¿â£¿â£¿â£¿
â¢ˆâ¢‚â ¸â °â¡â¢³â¡â¡„â â¢€â €â €â €â €â €â €â €â €â¡”â ˆâ €â €â €â €â €â¢â ¿â£”â£‹â¢®â£¥â£›â¡–â£¼â£‘â¢â¡³â¢¯â£µâ£¿â£·â¡–â£¼â£·â£½â €â €â „â €â €â €â¢€â €â €â €â €â¢¸â¡…â¢ˆâ¢¸â£¿â¡â£¿â£¿â£¿
â €â  â¢€â ¡â ˜â¡¤â¢›â¡½â£³â£¦â£¥â£€â£€â£„â €â£ â „â “â£€â£€â£„â  â¢€â €â €â¢ˆâ ³â¡œâ¢®â¡·â£â¡¾â£½â¡³â¢¯â¡–â¡¦â¢¿â£»â¢§â¡¿â£Ÿâ£»â£¯â ¯â¡€â €â ˜â¡€â €â ˆâ ‰â €â €â €â¢ â¡¿â €â¡ˆâ£¾â£¿â£¿â£»â£¿â£¿
â €â  â €â ˆâ â €â¡‰â â¡±â¢šâ£»â¢›â£¿â£»â£¿â£Ÿâ£¿â£¿â¡¿â¢»â£‹â ·â£¡â¡Ÿâ¡€â¢Œâ¢³â¢©â¢§â£‹â¡·â¢­â£²â£â¢³â¡œâ£¹â ³â£œâ¡³â¢¾â£™â¡¿â£¿â¡ƒâ¡¡â£„â¢¢â â „â €â €â €â¢€â¡°â Ÿâ â¢â£¿â£¿â¡¿â£¿â£³â£¿â£¿
â €â €â €â €â €â¢€â €â ‚â¡â Œâ¡Œâ¡»â£”â¢¯â£šâ£›â£³â£¾â£Ÿâ¡­â¢‡â£¾â¢·â ¿â „â Œâ£§â£›â¢¾â¡µâ¢¯â£›â ·â¡˜â¢‡â¡œâ¢†â¡â£â¢­â¡“â¢¿â£¿â£·â¡±â ¨â¢¹â£§â£½â£¿â£·â£¦â£·â£¦â£¶â£¶â£¾â£¿â£¿â£»â¡Ÿâ£¥â¡³â£¿â£¿
â €â €â¡€â¢€â¢ˆâ¢€â¡€â  â â  â ’â ”â ˆâ Œâ «â œâ¡µâ¢‹â ¶â¢¹â ®â£â¡½â¡â£â ³â£Œâ£¹â¢â ¿â¡­â â¢‚â â¡’â¢Œâ ¦â¡¹â£œâ ²â¡â¡„â »â£¿â¡·â¢„â  â¢µâ¡Œâ¡»â¢¿â¡â¢¯â ¿â£¿â£¿â£¿â¢¿â£™â •â¡šâ¢°â¡½â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â €â¡ˆâ ˆâ â¢‚â °â¢‰â ²â£¡â¢¯â¡¿â£¯â£¼â£¬â¡—â¢¾â¡­â¡â¡¸â â¡â¢€â Šâ ´â£‰â£–â ³â£œâ¡³â£â¡â£¤â ¹â£¿â£„â£€â£ â£¥â¡•â ˜â¢â¢¦â¡™â£¾â¢µâ¢®â¡™â  â ¡â¡˜â ¶â£½â£¿â£¿
â €â €â ˜â €â €â €â €â €â €â €â ˜â €â €â €â¢€â ƒâ¡˜â °â ‡â ·â£â¡¾â£¶â¢¿â£¿â£Ÿâ£»â£‡â Ÿâ¡³â ƒâ €â €â €â †â €â €â¡›â ›â ƒâ¢›â ˆâ  â ¶â ¸â£¿â£¿â£¿â¡¿â¢¿â ¸â¡†â ±â ˆâ¡›â ¶â¡†â  â ƒâ£„â¢¹â¢»â£¾â£¿â£¿
â €â €â €â ‚â €â €â €â €â €â €â €â €â €â â ‚â  â â Šâ¢â £â£»â¢¾â£»â£¯â¡Ÿâ¢¿â ½â¡†â €â ‘â €â €â €â €â €â ˆâ €â¡€â â¢€â €â €â €â €â €â¢¸â£¿â£¿â£¿â£¿â¢â ˆâ£„â €â â €â â¡¡â¢¡â¢â¢§â£»â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â â ˆâ¢â ¦â£™â¢¼â¢»â¡µâ¡šâ£½â£»â£¿â£¿â£¦â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£¼â£¿â£¿â£¿â£¿â£¿â¡“â ˆâ¢‚â €â €â „â €â¢£â â£â£¿â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â €â¡€â „â ‚â¡„â¢£â¡â¢¤â£’â ‰â â¡´â¢‹â¢¦â â¢â¡¿â¢¿â£¿â£ â¡€â €â €â €â €â €â €â €â €â €â €â¢€â£´â£¾â£¿â£¿â£¿â£¿â£»â¡·â£”â ”â €â¢€â €â¢€â ƒâ¢â¡½â£¿â£¿â£¿â£¿â£¿
â €â €â „â €â €â €â €â €â €â €â  â â €â ‚â â¡ˆâ †â£‰â¡˜â£¨â¢‡â¢â¡²â¢‹â ¤â£©â£¶â ¼â£«â¢â£½â£¿â£¶â£†â €â €â €â €â €â €â¢€â£€â£¿â£¿â£¿â£â£¾â£·â£¿â£…â¢Ÿâ¡â¢¿â£¦â¡â ¢â œâ¡Œâ£§â£Ÿâ£¿â£¿â£¿â£¿â£¿
â €â €â €â €â ˆâ €â €â €â €â â €â €â €â¢‚â¡µâ£¬â¡™â¢œâ¢³â £â¡â ¥â “â¢Šâ  â¡¡â¢‚â£›â£²â£™â¢»â£»â¢¿â£¿â£·â¡€â €â €â €â¡€â¢¾â »â£¯â£»â£¿â¡¿â »â£¶â «â¢¿â¢¬â£â¢®â£¯â ©â¡¦â¢â ˜â£—â£ºâ£¿â£¿â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â ˆâ£â ‹â ‚â â €â €â Šâ  â£â  â¢â¡¤â –â¡‘â£’â £â¢ƒâ¡–â£šâ ¯â£“â¢‹â¢‰â¡¾â Ÿâ €â €â °â ¿â¡²â¢½â£Œâ£»â£¿â ¿â£¿â¢¯â£…â£â£¡â ™â „â ªâ£·â£¶â¡ˆâ¢‘â£ˆâ ³â¢¿â£¿â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â¡€â¢€â ˆâ£ â ¡â â ¡â “â ’â œâ ’â ‹â ’â ˆâ Œâ£€â ±â£ˆâ œâ£‚â¢³â ¤â¡‰â â¡â¡â ‚â €â â¡€â ƒâ¢¶â¡§â£„â£â ³â£²â¡¬â ™â¢›â »â£¶â¢¾â£´â¡˜â §â£™â ¦â¢­â£¿â£·â£¾â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â ‚â â €â â €â â €â ˆâ¢€â  â¢€â ˜â£€â °â¢ˆâ¡’â¢€â â ‰â¡â ’â â ‚â ˜â €â €â €â €â ƒâ¢™â¢†â¢»â£¤â¡™â ·â €â ¹â£³â¡€â¢”â €â ‚â¢¹â¡¿â¢¢â¡â£–â¡ˆâ¢›â ¿â£¿â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â €â €â â¡€â „â¡ â ˆâ â €â â ˆâ¢€â  â €â â €â¢Šâ €â¡â ‘â €â €â €â €â €â €â €â €â ˆâ €â šâ¡¸â£â ‹â¢‚â¢¥â €â €â ªâ ˜â£•â ²â¢Œâ¡‰â¢£â¢â£©â¢¿â£¿â£¿â£¾â£â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â €â €â â €â €â €â €â €â €â €â¢€â €â €â ‚â €â €â €â €â €â €â €â¢€â „â €â €â €â €â €â €â €â €â €â ˆâ¢“â ˆâ¡Œâ ‚â¡µâ ¸â£§â ½â£„â ²â¢Œâ ¨â£„â¢‰â£¿â£¿â£¿â£¿â£¿â£¿â£¿
â €â €â €â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â  â €â  â¡†â  â ‚â €â „â €â  â â €â¢„â¡€â¢Šâ ’â¡Œâ¢°â ˆâ£ˆâ ³â â¡²â¢¦â¡€â ™â¢¶â££â£”â£â¡¿â£¿â£¿â£¿â£¿
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡€â ‚â €â¢€â â¢ â â â¢‚â â €â£†â ˆâ ¤â¢ˆâ ²â¡€â â ˜â ¤â¢…â¢¢â£â ‚â¡‘â £â¡â ´â ˆâ£Ÿâ£›â¢·â£¯â£»â£¿â£¿â£¿
â €â „â¡€â ‚â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡€â¢‚â ‚â ‚â Œâ¢ â „â ‚â €â¡´â¢‰â ƒâ¡˜â ‚â â ˆâ¡â °â €â ˆâ ‚â Œâ¢â ˆâ£â â¡’â££â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿
â â¡ˆâ ”â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â â ˆâ €â ‚â €â €â â €â â €â €â €â €â €â €â €â €â ‚â €â ˆâ  â¢„â ¢â¡½â£½â¢¿â£»â¢¿â£¿â£¿â£¿â£¿â£¿
â â¡ˆâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ‚â €â â ˆâ €â  â ‘â£â¢³â¡­â¢¿â£»â¡Ÿâ£â¢¿â£»â£¿â£¿â£¿
â €â  â â €â â €â €â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â  â €â ’â €â â ‚â „â â â¡â¢šâ£Œâ¡¿â£·â£¯â ±â£â ¶â¡¹â¢¿â£¿â£¿â €â €â €â €â €â €â €â €â €â €â €â €â €â €
 ______   ______    __   __          __   __  __    _  _______  ______   
|      | |    _ |  |  | |  |        |  |_|  ||  |  | ||       ||    _ |  
|  _    ||   | ||  |  |_|  |        |       ||   |_| ||_     _||   | ||  
| | |   ||   |_||_ |       |        |       ||       |  |   |  |   |_||_ 
| |_|   ||    __  ||       |        |       ||  _    |  |   |  |    __  |
|       ||   |  | | |     |  _____  | ||_|| || | |   |  |   |  |   |  | |
|______| |___|  |_|  |___|  |_____| |_|   |_||_|  |__|  |___|  |___|  |_|
A script by Dion Hobdy [ https://github.com/dionhobdy ]

EOF
echo #

# backup fstab, keeping only the 5 most recent backups
echo "ğŸ’¾ Backing up /etc/fstab..."
sudo ls -t /etc/fstab.bak.* | tail -n +6 | xargs sudo rm -f
sudo cp /etc/fstab "/etc/fstab.bak.$(date +%Y%m%d%H%M%S)"
echo "âœ… Backup complete."
echo #

# create ~/ext_drives directory if it doesn't exist
if [ ! -d "~/ext_drives" ]; then
    echo "ğŸ“‚ Creating ~/ext_drives directory..."
    mkdir ~/ext_drives
    echo #
fi
echo "ğŸ“ Changing to ~/ext_drives directory..."
cd ~/ext_drives || exit 1

while true; do
    # list all mountable drives and their mountpoints
    lsblk

    echo #

    # prompt user asking for input
    read -p "(M)ount drive, (U)nmount drive, or (E)xit? [M/U/E]: " mount_choice

    case "$mount_choice" in
        [uU]|[uU][nN][mM][oO][uU][nN][tT])
            # list currently mounted drives
            echo #
            # prompt user to enter the device name to unmount
            read -p "Enter the device name to unmount [e.g. sdX1]: " unmount_device
            echo #
            # unmount the specified device
            sudo umount "/dev/$unmount_device"
            echo "âœ… Unmounted /dev/$unmount_device"
            echo #
            ;;
        [mM]|[mM][oO][uU][nN][tT])
            # prompt user to select a listed
            read -p "Enter the device name [e.g. sdX1]: " device
            echo #
            echo "ğŸ” Checking device information for /dev/$device..."
            echo #
            # display detailed information about the selected drive using file, blkid, hexdump, and fdisk
            sudo file "/dev/$device"
            sudo blkid "/dev/$device"
            echo #
            sudo hexdump -C "/dev/$device" | head
            echo #
            sudo fdisk -l "/dev/$device"
            echo #
            echo "ğŸ“‚ Listing contents of /dev/$device (read-only)..."
            echo #
            # list contents of the drive by temporarily mounting the drive
            sudo mkdir /mnt/temp
            sudo mount -o ro "/dev/$device" /mnt/temp
            ls /mnt/temp
            sudo umount /mnt/temp
            echo #
            # confirm that the user would want to mount the drive
            read -p "Are you sure you want to mount $device? (y/n): " confirm_mount
            # if the user does not confirm dive mount, cancel and exit
            if [[ ! "$confirm_mount" =~ ^[yY]|[yY][eE][sS]$ ]]; then
                echo "ğŸš« Mounting cancelled."
                echo #
                break
            fi
            # prompt user to enter a mountpoint
            read -p "Enter the mount point [e.g. mydrive]: " mount_point
            echo #
            sudo mkdir -p "$mount_point"
            # mount the selected drive to the mountpoint
            sudo mount "/dev/$device" "$mount_point"
            echo #
            echo "âœ… Mounted $device at $mount_point"
            echo #
            # ask user if they want to make the mount permanent by adding it to /etc/fstab
            read -p "Do you want to make this mount permanent (auto-mount on reboot)? (y/n): " persist_choice
            if [[ "$persist_choice" =~ ^[yY]|[yY][eE][sS]$ ]]; then
                # get UUID of the device
                uuid=$(sudo blkid -s UUID -o value "/dev/$device")
                # get filesystem type
                fstype=$(sudo blkid -s TYPE -o value "/dev/$device")
                # create fstab entry
                fstab_entry="UUID=$uuid /home/ext_drives/$mount_point $fstype defaults 0 2"
                # backup fstab before modifying
                sudo cp /etc/fstab /etc/fstab.bak
                # append entry to fstab
                echo "$fstab_entry" | sudo tee -a /etc/fstab > /dev/null
                echo "ğŸ“Œ Persistent mount added to /etc/fstab:"
                echo "$fstab_entry"
            else
                echo "ğŸ•’ Mount will not persist after reboot."
            fi
            ;;
        [eE]|[eE][xX][iI][tT])
            echo "ğŸ‘‹ Exiting script. Goodbye!"
            break
            ;;
        *)
            echo "âš ï¸ Invalid choice. Please enter [M/U/E]."
            echo #
            ;;
    esac

    echo #
done
